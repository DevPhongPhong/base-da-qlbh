@model Entities.DTOs.ProductViewModel
@{
    ViewData["Title"] = Model.Name;
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{
    var chooseColor = (int)ViewBag.ChooseColor;
    var chooseLength = (int)ViewBag.ChooseLength;
    var chooseProduct = (int)ViewBag.ChooseProduct;
    var chooseQuantity = (int)ViewBag.ChooseQuantity;
    var message = (string)TempData["sentContact"];
    var listFeedback = (List<Entities.Models.Feedback>)ViewBag.ListFeedback;
}
<section class="products-detail-section pt_large">
    <div class="container">
        <div class="title text-left">
            <h4>Thông tin sản phẩm </h4>
        </div>
        <div class="row">
            <div class="col-md-5">
                <div class="product-image">
                    <img class="product_img" src="@Model.MainImageThumb" data-zoom-image="@Model.MainImageThumb">
                </div>
                <div id="pr_item_gallery" class="product_gallery_item owl-thumbs-slider owl-carousel owl-theme owl-loaded owl-drag">

                    @if (Model.ProductImages.Count > 0)
                    {
                        <div class="owl-stage-outer">
                            <div class="owl-stage" style="transform: translate3d(0px, 0px, 0px); transition: all 0s ease 0s; width: 228px;">
                                @foreach (var item in Model.ProductImages)
                                {
                                    <div class="owl-item active" style="width: 103.75px; margin-right: 10px;">
                                        <div class="item">
                                            <a href="#" class="active" data-image="@item.ThumbImage" data-zoom-image="@item.ThumbImage">
                                                <img src="@item.ThumbImage">
                                            </a>
                                        </div>
                                    </div>
                                }

                            </div>
                        </div><div class="owl-nav disabled">
                            <button type="button" role="presentation" class="owl-prev disabled">
                                <i class="ion-ios-arrow-back"></i>
                            </button>
                            <button type="button" role="presentation" class="owl-next disabled">
                                <i class="ion-ios-arrow-forward"></i>
                            </button>
                        </div>
                        <div class="owl-dots disabled"></div>
                    }

                </div>
            </div>
            <div class="col-md-7">
                <div class="quickview-product-detail">
                    <h2 class="box-title">@Model.Name</h2>
                    <p class="cart-price">
                    </p>
                    <h3 class="box-price">
                        @if (Model.IsPromote)
                        {
                            <del>@Model.Price?.ToString("N0") đ</del>
                            @Model.PromotionPrice?.ToString("N0")
                        }
                        else
                        {
                            @Model.Price?.ToString("N0")
                        }
                        đ
                    </h3>
                    @*<p class="box-text">--Nội dung sản phẩm--</p>*@
                    <p class="stock">Trạng thái: <span>@((Model.Quantity>0) ? "Còn hàng":"Hết hàng")</span></p>
                    @if (Model.Quantity > 0)
                    {
                        <div class="quantity-box">
                            <p>Số lượng:</p>
                            <div class="input-group">
                                <input type="button" value="-" class="minus">
                                <input id="quantity" class="quantity-number qty" type="text" value="@chooseQuantity" min="1" max="10">
                                <input type="button" value="+" class="plus">
                            </div>
                            <div class="quickview-cart-btn">
                                <button onclick="addtocart()" href="#" class="btn btn-primary "><img src="/assets/images/cart-icon-1.png" alt="cart-icon-1"> Thêm vào giỏ hàng</button>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-warning"> Sản phẩm đã hết hàng!</div>
                    }

                    <div class="box-social-like d-sm-flex justify-content-between">
                        @*<ul class="hover-icon box-like">
                                <li><a href="https://www.facebook.com/ThuyLinh.20112000"><i class="fa fa-heart"></i></a></li>
                                <li><a href="https://www.facebook.com/ThuyLinh.20112000"><i class="fa fa-refresh"></i></a></li>
                            </ul>*@
                        <ul class="hover-icon box-social">
                            <li><a href="https://www.facebook.com/ThuyLinh.20112000"><i class="fa fa-facebook"></i></a></li>
                            <li><a href="https://www.facebook.com/ThuyLinh.20112000"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="https://www.facebook.com/ThuyLinh.20112000"><i class="fa fa-linkedin"></i></a></li>
                            <li><a href="https://www.facebook.com/ThuyLinh.20112000"><i class="fa fa-pinterest-p"></i></a></li>
                            <li><a href="https://www.facebook.com/ThuyLinh.20112000"><i class="fa fa-google-plus"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <hr />
        <div class="title text-left">
            <h4>Chi tiết sản phẩm</h4>
        </div>
        <span>@Html.Raw((string.IsNullOrEmpty(Model.Description) ? "<p>Nội dung đang được cập nhật ...</p>": Model.Description))</span>
        <hr />
        @if (listFeedback != null && listFeedback?.Count > 0)
        {
            <div class="title text-left">
                <h4>Feedback của khách hàng</h4>
            </div>
            <div class="col-md-12">
                <ul>
                    @foreach (var item in listFeedback)
                    {
                        <li>
                            <div class="row" style="border: 2px solid red; padding: 10px; border-radius: 15px;">
                                <div class="col-2"><img src="@item.Avatar" style="width:100px" /></div>
                                <div class="col-10">
                                    <span>@item.Name | </span>
                                    <span style="color:red"><b>@item.Subject</b> &nbsp;&nbsp;&nbsp;&nbsp;  @item.CreateDate.ToString("dd/MM/yyyy : HH:mm")</span>
                                    <br />
                                    <p>@item.Message</p>
                                </div>
                            </div>
                            <hr />
                        </li>
                    }
                </ul>
            </div>
        }
        <hr />
        <div id="alertSent">
            @if (message == "success")
            {
                <div class="alert alert-success">Đã gửi</div>
            }
            else if (message == "error")
            {
                <div class="alert alert-danger">Lời nhắn chưa được gửi, vui lòng gửi lại sau!</div>
            }
        </div>
        <div class="contact-inputs">
            <div class="title text-left">
                <h4>Để lại feedback của bạn về sản phẩm này</h4>
            </div>
            <form method="post" class="contact-form form-with-label" action="@Url.Action("Contact","Home")" asp-antiforgery="true">
                <div class="input-1">
                    <label>Họ tên<span>*</span></label>
                    <input required="true" class="form-control" name="name" placeholder="Họ tên" value="" type="text">
                </div>
                <div class="input-2">
                    <label>Email<span>*</span></label>
                    <input required="true" class="form-control" name="email" placeholder="Email" value="" type="email">
                </div>
                <div class="input-3">
                    <label>Số điện thoại<span>*</span></label>
                    <input required="true" class="form-control" name="phone" placeholder="Số điện thoại" value="" type="text">
                </div>
                <div class="input-4">
                    <label>Chủ đề<span>*</span></label>
                    <input required="true" class="form-control" name="subject" placeholder="Chủ đề" value="" type="text">
                </div>
                <div class="input-5">
                    <label>Tin nhắn<span>*</span></label>
                    <textarea required="true" rows="3" class="form-control" name="description" placeholder="Nội dung"></textarea>
                </div>
                <div class="submit-btn">
                    <button type="submit" class="btn btn-primary">Gửi</button>
                </div>
                <input type="hidden" name="type" value="2">
                <input type="hidden" name="objID" value="@Model.Id">
                <input type="hidden" name="url" id="sendUrl" value="">
                <script>
                    var obj = document.getElementById("sendUrl");
                    obj.value = window.location.pathname + window.location.search;
                </script>
                <div class="col-md-12">
                    <div id="alert-msg" class="alert-msg text-center"></div>
                </div>
            </form>
        </div>
    </div>
</section>
<!-- End Product Detail Section -->
<!-- Product Review Start-->
<!-- Product Review End-->
<!-- Relative Product Start-->
<!-- Relative Product End-->
<script>
    $("#dec").click(function () {
        var crdt = $("#quantity").val();
        if (crdt > 0) {
            crdt--;
        }
        $("#quantity").val(crdt);
    });
    $("#inc").click(function () {
        var crdt = $("#quantity").val();
        crdt++;
        $("#quantity").val(crdt);
    });
    function addtocart() {
        var url = '@Url.Action("AddItem", "Cart")';
        var product = @chooseProduct;
        var quantity = $('#quantity').val();
        var fullUrl = url + '?productId=' + product + '&quantity=' + quantity;
        debugger
        window.location = fullUrl;
    }
</script>